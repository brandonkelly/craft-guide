var e=Object.defineProperty,t=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,a=(t,l,i)=>l in t?e(t,l,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[l]=i,n=(e,n)=>{for(var d in n||(n={}))l.call(n,d)&&a(e,d,n[d]);if(t)for(var d of t(n))i.call(n,d)&&a(e,d,n[d]);return e};import{d,r,e as o,x as s,l as u,z as c,c as p,a as g,b as h,o as m,p as v,L as y}from"./globals.a6fc57ea.js";import{_ as b,a as f}from"./SvgSettings.acb64152.js";var S=d({emits:["loaded"],created(){this.$emit("loaded")}});S.render=function(e,t,l,i,a,n){return null};var E=d({name:"PlacementInlineEditor",components:{CraftFieldSelect:b},props:{placementId:String,placementInlineEditor:{type:String,required:!0}},setup:e=>{const t=r({guides:u,guideValue:null,placement:null,placementSaved:!1});return t.placement={access:"all",group:"uiElement",groupId:e.placementInlineEditor,guideId:null,id:parseFloat(e.placementId)||null,portalMethod:"append",selector:null,theme:"default",uri:null},n({},o(t))},computed:{guideFieldOptions(){const e=[{label:"Select One",value:"__none__"}];return this.guides.forEach((t=>{e.push({label:t.title,value:t.slug})})),e}},methods:{async deletePlacement(){var e,t;(null==(e=this.placement)?void 0:e.id)&&await(null==(t=window.Craft)?void 0:t.postActionRequest("guide/placement/delete-placement",{data:JSON.stringify(this.placement)},((e,t,l)=>{var i,a,n,d;s("Deleting placement",e,t,l),this.placementSaved=!0,"success"===e.status?null==(a=null==(i=window.Craft)?void 0:i.cp)||a.displayNotice("Guide removed"):null==(d=null==(n=window.Craft)?void 0:n.cp)||d.displayError(e.data.error)})))},onGroupChanged(e){this.guideValue=e},onSaveClicked(){"__none__"===this.guideValue?this.deletePlacement():this.savePlacement()},async savePlacement(){var e;const t=this.guides.find((e=>e.slug===this.guideValue));t&&(this.placement.guideId=t.id),await(null==(e=window.Craft)?void 0:e.postActionRequest("guide/placement/save-placement",{data:JSON.stringify(this.placement)},((e,t,l)=>{var i,a,n,d;s("Saving placement",e,t,l),this.placementSaved=!0,"success"===e.status?null==(a=null==(i=window.Craft)?void 0:i.cp)||a.displayNotice("Guide UI element updated"):null==(d=null==(n=window.Craft)?void 0:n.cp)||d.displayError(e.data.error)})))}},mounted(){this.$refs.guideField.setFieldValue(this.guideFieldOptions[0].value),s("PlacementInlineEditor loaded")}});const w={key:0},C={key:0},I={key:0},G={key:1},T={key:1},O={key:2},N=g("p",null,"No guides have been created yet. Create a guide and then return here to select it for this UI element.",-1);E.render=function(e,t,l,i,a,n){const d=c("CraftFieldSelect");return e.placementInlineEditor?(m(),p("div",w,[e.placementSaved?(m(),p("div",C,["__none__"===e.guideValue?(m(),p("p",I,"Guide removed. Please reload this page and select another guide.")):(m(),p("p",G,"Guide added. Please reload this page to see the guide displayed here."))])):e.guides.length?(m(),p("div",T,[g(d,{ref:"guideField",instructions:"Select a guide to be displayed here.",label:"Guide",name:"guide",options:e.guideFieldOptions,onValueChanged:e.onGroupChanged},null,8,["options","onValueChanged"]),g("button",{class:"btn submit",type:"button",onClick:t[1]||(t[1]=(...t)=>e.onSaveClicked&&e.onSaveClicked(...t))},"Save")])):(m(),p("div",O,[N]))])):h("",!0)};var _=d({name:"GuideDisplay",delimiters:["${","}"],components:{OnLoad:S,PlacementInlineEditor:E,SvgSettings:f},props:{enableInlineEditor:Boolean,guideDisplay:{type:String,required:!0},guideNavData:String,startInInlineEditor:{type:Boolean,required:!1},teleportContainerClass:String,teleportMethod:String,teleportSelector:String},setup:e=>{const t=r({currentGuide:"",data:{},guideNav:e.guideNavData?JSON.parse(e.guideNavData):[],enableTldr:!1,proEdition:v,showInlineEditor:!1,showTldr:!1});return t.proEdition&&t.guideNav.forEach((e=>{t.data[e.slug]={boolean1:!1,boolean2:!1,boolean3:!1,boolean4:!1,boolean5:!1,number1:0,number2:0,number3:0,number4:0,number5:0,string1:"",string2:"",string3:"",string4:"",string5:""}})),n({},o(t))},computed:{teleportTarget(){return this.teleportSelector?`#teleport-${this.guideDisplay}`:null}},methods:{toggleTldr(e){s("Turning TLDR: "+(e?"on":"off")),this.showTldr=e;document.querySelectorAll(".tldr-show").forEach((t=>{e?t.removeAttribute("hidden"):t.setAttribute("hidden","hidden")}));document.querySelectorAll(".tldr-hide").forEach((t=>{e?t.setAttribute("hidden","hidden"):t.removeAttribute("hidden")})),localStorage.setItem("guide:display:tldr",e?"true":"false")},updateEnableTldr(){if(this.currentGuide){const e=document.querySelector(`.guide-${this.currentGuide} .tldr-hide, .guide-${this.currentGuide} .tldr-show, .guide-${this.currentGuide} [class^="tldr:"]`);s(`.guide-${this.currentGuide}`,e),this.enableTldr=null!==e}}},created(){var e;(null==(e=this.guideNav)?void 0:e.length)&&(this.currentGuide=this.guideNav[0].slug),this.showInlineEditor=this.startInInlineEditor},mounted(){this.updateEnableTldr(),this.toggleTldr("true"===localStorage.getItem("guide:display:tldr")),s("GuideDisplay loaded")},watch:{currentGuide(){this.$nextTick((()=>{this.updateEnableTldr(),this.toggleTldr(this.showTldr)}))}}});const D=document.querySelectorAll("[data-guide-display]");D&&D.forEach((e=>{var t,l,i,a;if(null==(t=e.dataset)?void 0:t.guideDisplay){if(null==(l=e.dataset)?void 0:l.teleportSelector){const t=document.querySelector(e.dataset.teleportSelector);if(t){const l=document.createElement("div");l.id=`teleport-${e.dataset.guideDisplay}`,(null==(i=e.dataset)?void 0:i.teleportContainerClass)&&l.setAttribute("class",e.dataset.teleportContainerClass),"append"===(null==(a=e.dataset)?void 0:a.teleportMethod)?t.appendChild(l):t.insertBefore(l,t.firstChild)}}_.template=`#${e.dataset.guideDisplay}`,y(n({},_),e.dataset).mount(e)}}));
